<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:b="http://bootsfaces.net/ui"
	template="/templates/full-page-form.xhtml">


	<ui:define name="document-title">Edit Business Practice</ui:define>

	<ui:define name="page-name">Administrator: &#160; <strong>Edit Business Practice</strong></ui:define>

	<ui:define name="full-page-form">

		<h:form id="BusinessAttributionEditForm">		
			<b:panel>
				<b:row>
					<b:column col-md="12">
						<span class="rowSpace"><br/></span>
					</b:column>
				</b:row>

				<b:row>
					<b:column col-md="6" offset="3">
						<b:messages></b:messages>
					</b:column>
				</b:row>

				<b:row>
					<b:column col-md="8" offset="4" class="form-title">#{businessAttribution.selectedBusName}</b:column>
				</b:row>

				<b:row>
					<b:column col-md="12">
						<span class="rowSpace"><br/><br/></span>
					</b:column>
				</b:row>

				<b:row>
					<b:column col-md="3" offset="1" class="form-input-label">Business Interruption Threshold:</b:column>
					<b:column col-md="4">
						<b:selectOneMenu label="BIT" render-label="false" id="bit" value="#{businessAttribution.bit}" tooltip="Choose a Business Interruption Threshold" required="false" requiredMessage="Business Interruption Threshold is required">
							<f:selectItems value="#{businessAttribution.bits}" var="bit" itemValue="#{bit}" itemLabel="#{bit}"></f:selectItems>
						</b:selectOneMenu>
					</b:column>
				</b:row>

	 			<b:row>
					<b:column col-md="3" offset="1" class="form-input-label">Business Criticality:</b:column>
					<b:column col-md="4">
						<b:selectOneMenu label="BCRIT" render-label="false" id="busCrit" value="#{businessAttribution.busCrit}" tooltip="Choose a Business Criticality Level" required="false" requiredMessage="Business Criticality Level is required.">
							<f:selectItems value="#{businessAttribution.bcrits}" var="busCrit" itemValue="#{busCrit}" itemLabel="#{busCrit}"></f:selectItems>
						</b:selectOneMenu>
					</b:column>
				</b:row>

 				<b:row>
					<b:column col-md="3" offset="1" class="form-input-label">Breach Types:</b:column>
					<b:column col-md="4">
						<b:selectOneMenu label="DBTYPE" render-label="false" id="dbType" value="#{businessAttribution.dbType}" tooltip="Choose a default Breach Type" required="false">
							<f:selectItems value="#{businessAttribution.dbtypes}" var="dbType" itemValue="#{dbType}" itemLabel="#{dbType}"></f:selectItems>
						</b:selectOneMenu>
					</b:column>
				</b:row>

				<b:row>
					<b:column col-md="3" offset="1" class="form-input-label">Information Classification:</b:column>
					<b:column col-md="4">
						<b:selectOneMenu label="INFClass" render-label="false" id="infClass" value="#{businessAttribution.infClass}" tooltip="Choose a level of classification" required="false" requiredMessage="Classification Level is required.">
							<f:selectItems value="#{businessAttribution.iclass}" var="infClass" itemValue="#{infClass}" itemLabel="#{infClass}"></f:selectItems>
						</b:selectOneMenu>
					</b:column>
				</b:row>

				<b:row>
					<b:column col-md="3" offset="1" class="form-input-label">Risk Appetite:</b:column>
					<b:column col-md="4">
						<b:inputText id="riskAppetite" value="#{businessAttribution.riskAppetite}" ask="decimal" maxlength="3"  required="false">
							<f:validateLongRange minimum="0" maximum="100" validatorMessage="risk appetite must be between 0 and 100"/>
						</b:inputText>
					</b:column>
				</b:row>

				<b:row>
					<b:column col-md="3" offset="1" class="form-input-label">Resistance Strength:</b:column>
					<b:column col-md="4">
						<b:inputText id="resistanceStrength" value="#{businessAttribution.resistanceStrengthstr}" ask="decimal" maxlength="4"  required="false" tooltip="Value must be 2, 16, 84, 98, or between 40 and 60">							
							<f:validateRegex pattern="^2|16|84|98|4[0-9]|5[0-9]|60" minimum="2" maximum="60" validatorMessage="Value must be 2, 16, 84, 98, or between 40 and 60" />
						</b:inputText>
					</b:column>
				</b:row>

				<b:row>
					<b:column col-md="3" offset="1" class="form-input-label">Annual Revenue:</b:column>
					<b:column col-md="4">
						<b:inputText id="annRevC" value="#{businessAttribution.annRevC}" mask="currency"  required="false" requiredMessage="Annual Revenue is required">      						<!-- <f:facet name="prepend"><h:outputText value="$" /></f:facet>
      						<f:facet name="append"><h:outputText value=".00" /> -->
						</b:inputText>							
					</b:column>
				</b:row>  
				
				<b:row>
					<b:column col-md="3" offset="1" class="form-input-label">Annual Revenue Year:</b:column>
					<b:column col-md="4">
						<b:inputText id="annRevYear" value="#{businessAttribution.annRevYear}" maxlength="4" required="false">
						</b:inputText>
					</b:column>
				</b:row>

				<b:row>
					<b:column col-md="3" offset="1" class="form-input-label">Record Count:</b:column>
					<b:column col-md="4">
						<b:inputText id="recordCount" value="#{businessAttribution.recordCount}" required="false">
						</b:inputText>
					</b:column>
				</b:row>

				<b:row>
					<b:column col-md="12">
						<b:accordion><b:panel id="pnlHosts" title="Hosts" styleClass="Hosts">
							<b:form id="frmHosts">
								<div style="text-align: center;">
									<b:commandButton value="Add" icon="add" ajax="true" update="@form" disabled="false" iconAwesome="plus" size="sm"  
										 	actionListener="#{businessAttribution.LoadHostAddDataforEdit()}" oncomplete="$('.modalClassAdd').modal('show');" >
										 	<f:ajax execute="@this" render="addHostTable hostSiteID hostSubnet"/>
										 	<!-- <f:ajax execute="@this" render="hostSiteID"/>
										 	<f:ajax execute="@this" render="hostSubnet"/> -->
									</b:commandButton>
								</div>
								<b:modal id="modalClassAdd" title="Add Hosts" styleClass="modalClassAdd">
									<div style="text-align: center;">
										<b:panel look="default" id="addPanel"  styleClass="addPanel">
											<b:row>
												<b:column col-md="3" offset="1" class="form-input-label">Site list:</b:column>
												<b:column col-md="4">
													<b:selectOneMenu label="hostSiteID" render-label="false" id="hostSiteID" value="#{businessAttribution.hostSiteID}"
														ajax="true" valueChangeListener="#{businessAttribution.listenSite}" tooltip="Choose a site" required="true" class="hostSiteID">
														<f:selectItems value="#{businessAttribution.siteList}" var="hostSiteID" itemValue="#{hostSiteID}" itemLabel="#{hostSiteID}"></f:selectItems>
														<f:ajax event="change" execute="@this" render="hostSubnet" />
													</b:selectOneMenu>
												</b:column>
											</b:row>
											<b:row>  
					 							<b:column col-md="3" offset="1" class="form-input-label">Subnet list:</b:column>
												<b:column col-md="4">
													<b:selectOneMenu label="hostSubnet" render-label="false" id="hostSubnet" value="#{businessAttribution.hostSubnet}" 
														ajax="true" valueChangeListener="#{businessAttribution.listenHardware}"  tooltip="Choose a subnet" required="true">
														<f:selectItems value="#{businessAttribution.subnetList}" var="hostSubnet" itemValue="#{hostSubnet}" itemLabel="#{hostSubnet}"></f:selectItems>
														<f:ajax event="change" execute="@this" render="addHostTable"/>
													</b:selectOneMenu>
												</b:column>
											</b:row>
										</b:panel>
									</div>
					 				<b:dataTable id="addHostTable" value="#{businessAttribution.addHostList}" var="addhost"  widgetVar="AddHostTable">
										<b:dataTableColumn id="hostIP" value="#{addhost.hostIP}" content-style="white-space:pre-wrap;">
											<f:facet name="header">IP<br/>Address</f:facet>
										</b:dataTableColumn>
										<b:dataTableColumn id="hostName" value="#{addhost.hostName}" content-style="white-space:pre-wrap; word-break:break-word;">
											<f:facet name="header">Host<br/>Name</f:facet>
										</b:dataTableColumn>
										<b:dataTableColumn value="#{addhost.hostVendor}" content-style="white-space:pre-wrap; word-break:break-word;">
											<f:facet name="header">Vendor</f:facet>
										</b:dataTableColumn>
										<b:dataTableColumn value="" orderable="false">						
											<f:facet name="header">Action</f:facet>		
											<b:commandButton value="Add host" look="primary" ajax="true" actionListener="#{businessAttribution.addBVAHostControllerMethodinEdit(addhost.hostID)}" 
												oncomplete="$('.modalClassAdd').modal('hide');" size="sm" onclick="HostTable.DataTable().destroy();" update="@form">
											 </b:commandButton>
										</b:dataTableColumn>	
					 				</b:dataTable>
									<div style="text-align: center;">
										<b:button value="Close/Cancel" dismiss="modal"/>
									</div>												
								</b:modal>
								<b:modal id="delModal" title="Delete host Confirmation" styleClass="modalClass" >
									<p class="modalText">Are you sure you want to delete this host, #{businessAttribution.selectedHostName} ?</p>
									<b:button value="Close" dismiss="modal"/>
									<b:commandButton value="Ok" look="primary" ajax="true" actionListener="#{businessAttribution.deleteBVAHostControllerMethodModal()}" 
												update="hostTable" oncomplete="$('.modalClass').modal('hide');" size="sm" disabled="false" >
										<f:ajax execute="@this" render="hostTable"/> 									
									</b:commandButton>		 	
								</b:modal>
								<b:dataTable id="hostTable" scrollHorizontally="true"  fixedHeader="true" value="#{businessAttribution.businessHostData}" var="host"  widgetVar="HostTable">
									<b:dataTableColumn value="#{host.hostName}" content-style="white-space:pre-wrap; word-break:break-word;">
										<f:facet name="header">Host<br/>Name</f:facet>
									</b:dataTableColumn>
									<b:dataTableColumn value="#{host.hostIP}" content-style="white-space:pre-wrap;">
										<f:facet name="header">IP<br/>Address</f:facet>
									</b:dataTableColumn>
									<b:dataTableColumn value="#{host.hostAType}" content-style="white-space:pre-wrap;">
										<f:facet name="header">Asset<br/>Type</f:facet>
									</b:dataTableColumn>
									<b:dataTableColumn value="#{host.hostAVisibility}" content-style="white-space:pre-wrap; word-break:break-word;">
										<f:facet name="header">Asset<br/>Visibility</f:facet>
									</b:dataTableColumn>
									<b:dataTableColumn value="#{host.hostOS}" content-style="white-space:pre-wrap; word-break:break-word;">
										<f:facet name="header">Operating<br/>System</f:facet>
									</b:dataTableColumn>
									<b:dataTableColumn value="#{host.hostVendor}" content-style="white-space:pre-wrap; word-break:break-word;">
										<f:facet name="header">Vendor</f:facet>
									</b:dataTableColumn>
									<b:dataTableColumn value="" orderable="false" id="ActionCol">
										<f:facet name="header">Action</f:facet>											
											<b:commandButton value="Delete" size="sm" look="default" ajax="true" oncomplete="$('.modalClass').modal('show');"
												actionListener="#{businessAttribution.defineSelectedHost(host)}" immediate="true" update=":BusinessAttributionEditForm:frmHosts:delModal" />
									</b:dataTableColumn>	
								</b:dataTable>
							</b:form>							
						</b:panel></b:accordion>
					</b:column>
				</b:row>
				<b:row>
					<b:column col-md="12">
						<span class="rowSpace"><br/></span>
					</b:column>
				</b:row>
				<b:row>
					<b:column col-md="2" offset="2"></b:column>
					<b:column col-md="4">
						<b:commandButton value="Save Changes" look="primary" action="#{businessAttribution.editBVAControllerMethod}"></b:commandButton>
						<b:button value="Cancel/Close" href="business-attribution-table.jsf"></b:button>
					</b:column>
				</b:row>

				<b:row>
					<b:column col-md="12">
						<span class="rowSpace"><br/></span>
					</b:column>
				</b:row>

			</b:panel>

		</h:form>

	</ui:define>

</ui:composition>
